<!DOCTYPE html>
<html lang="en">
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content="A fully featured admin theme which can be used to build CRM, CMS, etc."/>
    <style>
        .delete {
          border: 1px solid;
          background: red;
          color: white;
          border-radius: 6px;
          font-size: 12px;
        }


            .progress-ring circle {
                fill: none;
                stroke-width: 10;
            }
            .progress-ring .bg-ring {
                stroke: #e6e6e6;
            }
            .progress-ring .progress-ring-bar {
                stroke: #4caf50;
                transition: stroke-dashoffset 0.3s;
            }
           .percentage-text {
                font-size: 25px;
                text-anchor: middle;
                dominant-baseline: middle;
                fill: #333;
                font-weight: 800;
            }
    </style>
    <!-- Light/dark mode -->
    <script>
        /*!
         * Color mode toggler for Bootstrap's docs (https://getbootstrap.com/)
         * Copyright 2011-2024 The Bootstrap Authors
         * Licensed under the Creative Commons Attribution 3.0 Unported License.
         * Modified by Simpleqode
         */

        (() => {
          'use strict';

          const getStoredTheme = () => localStorage.getItem('theme');
          const setStoredTheme = (theme) => localStorage.setItem('theme', theme);

          const getPreferredTheme = () => {
            const storedTheme = getStoredTheme();
            if (storedTheme) {
              return storedTheme;
            }

            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
          };

          const setTheme = (theme) => {
            if (theme === 'auto') {
              document.documentElement.setAttribute('data-bs-theme', window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            } else {
              document.documentElement.setAttribute('data-bs-theme', theme);
            }
          };

          setTheme(getPreferredTheme());

          const showActiveTheme = (theme, focus = false) => {
            const themeSwitchers = document.querySelectorAll('[data-bs-theme-switcher]');

            themeSwitchers.forEach((themeSwitcher) => {
              const themeSwitcherIcon = themeSwitcher.querySelector('.material-symbols-outlined');
              themeSwitcherIcon.innerHTML = theme === 'light' ? 'light_mode' : theme === 'dark' ? 'dark_mode' : 'contrast';

              if (focus) {
                themeSwitcher.focus();
              }
            });

            document.querySelectorAll('[data-bs-theme-value]').forEach((element) => {
              element.classList.remove('active');
              element.setAttribute('aria-pressed', 'false');

              if (element.getAttribute('data-bs-theme-value') === theme) {
                element.classList.add('active');
                element.setAttribute('aria-pressed', 'true');
              }
            });
          };

          const refreshCharts = () => {
            const charts = document.querySelectorAll('.chart-canvas');

            charts.forEach((chart) => {
              const chartId = chart.getAttribute('id');
              const instance = Chart.getChart(chartId);

              if (!instance) {
                return;
              }

              if (instance.options.scales.y) {
                instance.options.scales.y.grid.color = getComputedStyle(document.documentElement).getPropertyValue('--bs-border-color');
                instance.options.scales.y.ticks.color = getComputedStyle(document.documentElement).getPropertyValue('--bs-secondary-color');
              }

              if (instance.options.scales.x) {
                instance.options.scales.x.ticks.color = getComputedStyle(document.documentElement).getPropertyValue('--bs-secondary-color');
              }

              if (instance.options.elements.arc) {
                instance.options.elements.arc.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--bs-body-bg');
                instance.options.elements.arc.hoverBorderColor = getComputedStyle(document.documentElement).getPropertyValue('--bs-body-bg');
              }

              instance.update();
            });
          };

          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
            const storedTheme = getStoredTheme();
            if (storedTheme !== 'light' && storedTheme !== 'dark') {
              setTheme(getPreferredTheme());
            }
          });

          window.addEventListener('DOMContentLoaded', () => {
            showActiveTheme(getPreferredTheme());

            document.querySelectorAll('[data-bs-theme-value]').forEach((toggle) => {
              toggle.addEventListener('click', (e) => {
                e.preventDefault();
                const theme = toggle.getAttribute('data-bs-theme-value');
                setStoredTheme(theme);
                setTheme(theme);
                showActiveTheme(theme, true);
                refreshCharts();
              });
            });
          });
        })();
    </script>

    <!-- Favicon -->
    <link rel="shortcut icon" href="../../../assets/favicon/favicon.html" type="image/x-icon"/>

    <!-- Fonts and icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com/"/>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&amp;display=swap"
          rel="stylesheet"/>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0"/>

    <!-- Libs CSS -->
    <link rel="stylesheet" href="../../../assets/css/libs.bundle.css"/>

    <!-- Theme CSS -->
    <link rel="stylesheet" href="../../../assets/css/theme.bundle.css"/>

    <!-- Title -->
    <title>Dashbrd</title>
</head>

<body>
<aside class="aside aside-sm d-none d-xl-flex">
    <nav class="navbar navbar-expand-xl navbar-vertical">
        <div class="container-fluid">
            <div class="collapse navbar-collapse" id="sidenavSmallCollapse">
                <!-- Nav -->
                <nav class="navbar-nav nav-pills h-100">
                    <div class="nav-item">
                        <div data-bs-toggle="tooltip" data-bs-placement="right" data-bs-trigger="hover"
                             data-bs-title="Color mode">
                            <a
                                    class="nav-link"
                                    data-bs-toggle="collapse"
                                    data-bs-theme-switcher
                                    href="#colorModeOptions"
                                    role="button"
                                    aria-expanded="false"
                                    aria-controls="colorModeOptions"
                            >
                                <span class="material-symbols-outlined mx-auto"> </span>
                            </a>
                        </div>
                        <div class="collapse" id="colorModeOptions">
                            <div class="border-top border-bottom py-2">
                                <a
                                        class="nav-link fs-sm"
                                        data-bs-toggle="tooltip"
                                        data-bs-placement="right"
                                        data-bs-trigger="hover"
                                        data-bs-title="Light"
                                        data-bs-theme-value="light"
                                        href="#"
                                        role="button"
                                >
                                    <span class="material-symbols-outlined mx-auto"> light_mode </span>
                                </a>
                                <a
                                        class="nav-link fs-sm"
                                        data-bs-toggle="tooltip"
                                        data-bs-placement="right"
                                        data-bs-trigger="hover"
                                        data-bs-title="Dark"
                                        data-bs-theme-value="dark"
                                        href="#"
                                        role="button"
                                >
                                    <span class="material-symbols-outlined mx-auto"> dark_mode </span>
                                </a>
                                <a
                                        class="nav-link fs-sm"
                                        data-bs-toggle="tooltip"
                                        data-bs-placement="right"
                                        data-bs-trigger="hover"
                                        data-bs-title="Auto"
                                        data-bs-theme-value="auto"
                                        href="#"
                                        role="button"
                                >
                                    <span class="material-symbols-outlined mx-auto"> contrast </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="nav-item" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-toggle="hover"
                         data-bs-title="Go to product page">
                        <a class="nav-link" href="https://themes.getbootstrap.com/product/dashbrd/" target="_blank">
                            <span class="material-symbols-outlined mx-auto"> local_mall </span>
                        </a>
                    </div>
                    <div class="nav-item mt-auto" data-bs-toggle="tooltip" data-bs-placement="right"
                         data-bs-toggle="hover" data-bs-title="Contact us">
                        <a class="nav-link" href="mailto:yevgenysim+simpleqode@gmail.com">
                            <span class="material-symbols-outlined mx-auto"> support </span>
                        </a>
                    </div>
                </nav>
            </div>
        </div>
    </nav>
</aside>
<aside class="aside">
    <nav class="navbar navbar-expand-xl navbar-vertical">
        <div class="container-fluid">
            <a class="navbar-brand fs-5 fw-bold px-xl-3 mb-xl-4" href="/">
                <i class="fs-4 text-secondary me-1" data-duoicon="box-2"></i> ETL
            </a>


            <!-- Toggler -->
            <button
                    class="navbar-toggler ms-3"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#sidenavLargeCollapse"
                    aria-controls="sidenavLargeCollapse"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
            >
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Collapse -->
            <div class="collapse navbar-collapse" id="sidenavLargeCollapse">
                <!-- Search -->
                <div class="input-group d-xl-none my-4 my-xl-0">
                    <input
                            class="form-control"
                            id="topnavSearchInputMobile"
                            type="search"
                            placeholder="Search"
                            aria-label="Search"
                            aria-describedby="navbarSearchMobile"
                    />
                    <span class="input-group-text" id="navbarSearchMobile">
                <span class="material-symbols-outlined"> search </span>
              </span>
                </div>

                <!-- Nav -->
                <nav class="navbar-nav nav-pills mb-7">
                    <div class="nav-item">
                        <a
                                class="nav-link"
                                href="#"
                                data-bs-toggle="collapse"
                                data-bs-target="#dashboards"
                                rol="button"
                                aria-expanded="false"
                                aria-controls="dashboards">
                            <span class="material-symbols-outlined me-3">space_dashboard</span> Dashboards
                        </a>
                        <div class="collapse" id="dashboards">
                            <nav class="nav nav-pills">
                                <a class="nav-link" href="index.html">Default</a>
                                <a class="nav-link " href="dashboards/crypto.html">Crypto</a>
                                <a class="nav-link " href="dashboards/saas.html">SaaS</a>
                            </nav>
                        </div>
                    </div>

                    <div class="nav-item">
                        <a
                                class="nav-link active"
                                href="#"
                                data-bs-toggle="collapse"
                                data-bs-target="#projects"
                                rol="button"
                                aria-expanded="false"
                                aria-controls="projects">
                            <span class="material-symbols-outlined me-3">list_alt</span> Jobs Management
                        </a>
                        <div class="collapse show" id="projects">
                            <nav class="nav nav-pills">
                                <a class="nav-link active" href="/job/running">Success / Failed Jobs</a>
                                <a class="nav-link " href="/job/new">New Job</a>
                            </nav>
                        </div>
                    </div>
                </nav>
                <hr class="my-4 d-xl-none"/>
                <nav class="navbar-nav nav-pills d-xl-none mb-7">
                    <div class="nav-item">
                        <a
                                class="nav-link"
                                data-bs-toggle="collapse"
                                data-bs-theme-switcher
                                href="#colorModeOptionsMobile"
                                role="button"
                                aria-expanded="false"
                                aria-controls="colorModeOptionsMobile"
                        >
                            <span class="material-symbols-outlined me-3"> </span> Color mode
                        </a>
                        <div class="collapse" id="colorModeOptionsMobile">
                            <div class="nav nav-pills">
                                <a class="nav-link" data-bs-theme-value="light" href="#" role="button"> Light </a>
                                <a class="nav-link" data-bs-theme-value="dark" href="#" role="button"> Dark </a>
                                <a class="nav-link" data-bs-title="Auto" data-bs-theme-value="auto" href="#"
                                   role="button"> Auto </a>
                            </div>
                        </div>
                    </div>
                    <div class="nav-item">
                        <a class="nav-link" href="https://themes.getbootstrap.com/product/dashbrd/" target="_blank">
                            <span class="material-symbols-outlined me-3">local_mall</span> Go to product page
                        </a>
                    </div>
                    <div class="nav-item">
                        <a class="nav-link" href="mailto:yevgenysim+simpleqode@gmail.com">
                            <span class="material-symbols-outlined me-3">alternate_email</span> Contact us
                        </a>
                    </div>
                </nav>

                <div class="card mt-auto">

                </div>
            </div>
        </div>
    </nav>
</aside>
<nav class="navbar d-none d-xl-flex px-xl-6">
     
</nav>

<main class="main px-lg-6" style="padding-top: 0% !important;">
    <div class="container-lg">
        <div class="row align-items-center mb-3">
            <div class="col-auto">
                <div class="avatar avatar-xl rounded text-primary">
                    <i class="fs-2" data-duoicon="clipboard"></i>
                </div>
            </div>
            <div class="col">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-2">
                        <li class="breadcrumb-item"><a class="text-body-secondary" href="#">Celery Jobs</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Tasks</li>
                    </ol>
                </nav>
                <h1 class="fs-4 mb-0">Dataset: {{ dataset.replace('_', ' ') }}</h1>
            </div>
            <div class="col-12 col-sm-auto mt-4 mt-sm-0">
                <a class="btn btn-secondary d-block" href="#!"> <span class="material-symbols-outlined me-1">add</span>
                    New project </a>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="form-group">
                    <label><b>Select columns to display</b>:</label>
                    <div class="checkboxes d-flex flex-wrap gap-3">
                        {% if data.columns %}
                            {% for column in data.columns %}
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input column-checkbox" data-column="{{ column }}" checked id="column-{{ column }}">
                                    <label class="form-check-label" for="column-{{ column }}">{{ column }}</label>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        

        <div class="row">
            <div class="col-12">
                <div class="table-responsive mb-7">
                    <table class="table table-selectable align-middle mb-0">
                        <thead>
                        <tr>
                            {% if data.columns %}
                            {% for column in data.columns %}
                            <th style="text-align:center ;">{{ column }}</th>
                            {% endfor %}
                            {% endif %}
                        </tr>
                        </thead>
                        <tbody>
                        {% if data.data %}
                        {% for task in data.data %}
                        <tr>
                            {% for column in data.columns %}
                            <td style="padding: 9px;text-align: center;">{{ task[column] }}</td>  <!-- Access dynamic data from rowsAsDict -->
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        {% else %}
                        <tr>
                            <td colspan="{{ columns|length + 1 }}" class="text-center">No tasks found</td>
                            <!-- Add 1 for the Action column -->
                        </tr>
                        {% endif %}
                        </tbody>
                    </table>

                </div>

            </div>
        </div>
        <div class="row">
            <div class="col-12">
                 <nav>
                        <ul class="pagination mb-0" style="justify-content: center">
                            {% if data.meta.page > 1 %}
                            <li class="page-item">
                                <a class="page-link" style="color: chocolate;border: 1px solid;"      
                                    href="{{ url_for('bp.jobsDataset', jobUuid=uuid, limit=data.meta.limit, page=data.meta.page - 1) }}">
                                    Previous
                                </a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <a class="page-link" href="#" style="color: chocolate;border: 1px solid;"    >Previous</a>
                            </li>
                            {% endif %}

                            <li class="page-item disabled">
                                <span class="page-link" style="color: black;font-weight: 600;">Page {{ data.meta.page }} of {{ (data.meta.total_count // data.meta.limit) + (1 if data.meta.total_count % data.meta.limit > 0 else 0) }}</span>
                            </li>

                            {% if data.meta.page < (data.meta.total_count // data.meta.limit) + (1 if data.meta.total_count % data.meta.limit > 0 else 0) %}
                            <li class="page-item">
                                <a class="page-link" style="color: chocolate;border: 1px solid;"     href="{{ url_for('bp.jobsDataset', jobUuid=uuid, limit=data.meta.limit, page=data.meta.page + 1) }}">Next</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <a class="page-link" href="#" style="color: chocolate;border: 1px solid;"    >Next</a>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
            </div>
        </div>
    </div>
</main>

<script>

    document.addEventListener('DOMContentLoaded', function () {
        const checkboxes = document.querySelectorAll('.column-checkbox');

        // Load saved checkbox states from localStorage
        const savedState = JSON.parse(localStorage.getItem('selectedColumns')) || {};

        // Set checkbox states based on localStorage
        checkboxes.forEach(checkbox => {
            const column = checkbox.getAttribute('data-column');
            if (savedState[column] !== undefined) {
                checkbox.checked = savedState[column];
            }

            // Attach event listener to update localStorage when a checkbox is changed
            checkbox.addEventListener('change', () => {
                savedState[column] = checkbox.checked;
                localStorage.setItem('selectedColumns', JSON.stringify(savedState));
                toggleColumns();  // Update the table visibility after changing selection
            });
        });

        // Initialize column visibility based on saved state
        toggleColumns();
    });

    // Function to toggle column visibility based on checkbox state
    function toggleColumns() {
        const checkboxes = document.querySelectorAll('.column-checkbox');
        checkboxes.forEach(checkbox => {
            const column = checkbox.getAttribute('data-column');
            const columnIndex = [...document.querySelectorAll('thead th')].findIndex(th => th.textContent.trim() === column);
            
            if (columnIndex !== -1) {
                const tableColumns = document.querySelectorAll(`tbody tr td:nth-child(${columnIndex + 1}), thead th:nth-child(${columnIndex + 1})`);
                tableColumns.forEach(cell => {
                    if (checkbox.checked) {
                        cell.style.display = '';
                    } else {
                        cell.style.display = 'none';
                    }
                });
            }
        });
    }

</script>




<script src="../../../assets/js/vendor.bundle.js"></script>
<script src="../../../assets/js/theme.bundle.js"></script>
</body>
</html>
